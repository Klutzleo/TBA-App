post:
  tags:
    - Combat
  summary: Resolve a combat roll between attacker and defender
  description: Compares weapon and defense dice to determine hit, miss, or critical outcome.
  consumes:
    - application/json
  produces:
    - application/json
  parameters:
    - in: body
      name: combat
      required: true
      schema:
        type: object
        properties:
          attacker:
            type: object
            properties:
              name: { type: string }
              stat: { type: string }
              PP: { type: integer }
              level: { type: integer }
          defender:
            type: object
            properties:
              name: { type: string }
              stat: { type: string }
              SP: { type: integer }
              level: { type: integer }
          weapon_die: { type: string, example: "1d8" }
          defense_die: { type: string, example: "1d6" }
          bap: { type: boolean }
  responses:
    200:
      description: Combat roll result
      schema:
        type: object
        properties:
          type: { type: string, example: "combat" }
          attacker_roll: { type: integer, example: 7 }
          defender_roll: { type: integer, example: 3 }
          outcome: { type: string, example: "hit" }
          narrative: { type: string, example: "Rook strikes true, bypassing Shade's defenses." }
          details:
            type: object
            properties:
              margin: { type: integer, example: 4 }
              critical: { type: boolean, example: false }
              bap_triggered: { type: boolean, example: false }